@media (prefers-color-scheme: dark) {
    .benefit-note {
      background: rgba(255, 204, 0, 0.15);
      color: #f5f5f7;
    }
  }.low{
  color:#1d1d1f;
  font-size:17px;
  margin:24px 0 20px;
  line-height:1.5;
  font-weight:400;
  padding: 16px 20px;
  background: rgba(255, 149, 0, 0.08);
  border-radius: 12px;
}

.low a {
  color:#0071e3;
  text-decoration:none;
  font-weight:400;
  transition: opacity 0.2s ease;
}

.low a:hover {
  opacity: 0.8;
  text-decoration: underline;
}

.hidden{
  display:none
}<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ãƒ¯ã‚¤ã‚¨ãƒ ãƒ¯ãƒ¼ã‚¯ã‚¹ â€“ ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ</title>
<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,'SF Pro Display','Segoe UI',Roboto,sans-serif;
  max-width:560px;
  margin:3rem auto;
  padding:0 32px;
  line-height:1.6;
  color:#1d1d1f;
  background:#fff;
  -webkit-font-smoothing: antialiased;
}

/* Dark Mode Support */
@media (prefers-color-scheme: dark) {
  body {
    color: #f5f5f7;
    background: #000;
  }
  
  textarea {
    color: #f5f5f7;
    background: #1c1c1e;
    border-color: #424245;
  }
  
  textarea:hover {
    border-color: #7a7a7c;
  }
  
  textarea:focus {
    background: #000;
  }
  
  button.secondary {
    background: #1c1c1e;
    color: #f5f5f7;
    border-color: #424245;
  }
  
  button.secondary:hover {
    background: #2c2c2e;
    border-color: #7a7a7c;
  }
  
  button:disabled {
    background: #1c1c1e;
    color: #8e8e93;
    border-color: #424245;
  }
  
  .high {
    background: rgba(52, 199, 89, 0.1);
  }
  
  .low {
    background: rgba(255, 149, 0, 0.1);
  }
  
  .helper-text {
    color: #a1a1a6;
  }
  
  .button-helper {
    color: #8e8e93;
  }
  
  .step-number {
    background: #2c2c2e;
    border-color: #424245;
  }
  
  .step-connector {
    background: #424245;
  }
}

textarea{
  width:100%;
  height:140px;
  margin-top:12px;
  margin-bottom:24px;
  border:1px solid #d2d2d7;
  border-radius:12px;
  padding:16px;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  font-size:16px;
  color:#1d1d1f;
  background:#fbfbfd;
  resize:vertical;
  outline:none;
  transition:border-color 0.2s ease, background-color 0.2s ease;
  box-sizing:border-box
}

textarea:hover{
  border-color:#86868b;
}

textarea:focus{
  border-color:#0071e3;
  background:#fff;
  box-shadow:0 0 0 4px rgba(0,113,227,0.1)
}

button{
  padding:12px 24px;
  font-size:16px;
  font-weight:500;
  cursor:pointer;
  border:none;
  border-radius:10px;
  display:inline-flex;
  align-items:center;
  gap:6px;
  transition:all 0.2s ease;
  min-height:44px;
  white-space: nowrap;
}

button.primary{
  background:#0071e3;
  color:white;
  margin-right: 12px;
}

button.primary:hover{
  background:#0077ED;
  transform:translateY(-1px);
  box-shadow: 0 4px 12px rgba(0,113,227,0.15);
}

button.primary:active{
  transform:translateY(0)
}

button.secondary{
  background:#f5f5f7;
  color:#86868b;
  border:1px solid #d2d2d7
}

button.secondary:hover{
  background:#e8e8ed;
  border-color:#86868b;
}

button.copied{
  background:#34c759;
  color:white
}

button.copied:hover{
  background:#30d158
}

button:disabled{
  background:#f5f5f7;
  color:#86868b;
  cursor:not-allowed;
  border:1px solid #d2d2d7;
  opacity: 0.6;
}

button:disabled:hover{
  background:#f5f5f7;
  transform:none;
  box-shadow: none;
}

h1{
  font-size:32px;
  font-weight:600;
  margin-bottom:8px;
  color:#1d1d1f;
  letter-spacing:-0.5px
}

small{
  color:#86868b;
  font-size:17px;
  font-weight:400
}

.high{
  color:#1d1d1f;
  font-size:17px;
  margin:24px 0 20px;
  line-height:1.5;
  font-weight:400;
  padding: 16px 20px;
  background: rgba(52, 199, 89, 0.08);
  border-radius: 12px;
}

.rating-thanks {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 18px;
  font-weight: 500;
  color: #34c759;
  margin-bottom: 12px;
}

.helper-text{
  margin-top:16px;
  margin-bottom:0;
  color:#86868b;
  font-size:14px;
  font-weight:400;
}

.benefit-note {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 24px;
  padding: 12px 16px;
  background: rgba(255, 204, 0, 0.08);
  border-radius: 8px;
  font-size: 14px;
  color: #1d1d1f;
}

/* Button section */
.button-section {
  margin-top:0;
  margin-bottom:40px;
}

/* Step flow indicator */
.flow-indicator {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin: 20px 0;
  font-size: 14px;
  color: #86868b;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.flow-indicator.show {
  opacity: 1;
}

.flow-step {
  display: flex;
  align-items: center;
  gap: 4px;
}

.flow-step.active {
  color: #0071e3;
  font-weight: 500;
}

.flow-step.completed {
  color: #34c759;
}

.flow-arrow {
  color: #d2d2d7;
  font-size: 16px;
}

/* Copy instruction */
.copy-instruction {
  background: rgba(0, 113, 227, 0.08);
  border-radius: 8px;
  padding: 12px 16px;
  margin-bottom: 16px;
  font-size: 14px;
  color: #0071e3;
  display: none;
  align-items: center;
  gap: 8px;
}

.copy-instruction.show {
  display: flex;
}

/* Button helper text - å‰Šé™¤ */
.button-helper {
  display: none;
}

.button-helper.show {
  display: block;
}

/* Focus visible for accessibility */
button:focus-visible,
textarea:focus-visible {
  outline: 2px solid #0071e3;
  outline-offset: 2px;
}

/* Toast notification */
.toast {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%) translateY(100px);
  background: #1d1d1f;
  color: #fff;
  padding: 12px 24px;
  border-radius: 8px;
  font-size: 15px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  opacity: 0;
  transition: all 0.3s ease;
  pointer-events: none;
}

.toast.show {
  transform: translateX(-50%) translateY(0);
  opacity: 1;
}

@media (prefers-color-scheme: dark) {
  .toast {
    background: #f5f5f7;
    color: #1d1d1f;
  }
}

/* Button pulse animation - ä»•æ§˜é€šã‚Š */
@keyframes pulse {
  0% {
    box-shadow: 0 0 0 0 rgba(0, 113, 227, 0.4);
  }
  70% {
    box-shadow: 0 0 0 12px rgba(0, 113, 227, 0);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(0, 113, 227, 0);
  }
}

button.primary.pulse {
  animation: pulse 2s infinite;
}

/* ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ - éè¡¨ç¤ºã« */
.step-indicator {
  display: none;
}

/* Mobile responsiveness */
@media (max-width: 600px) {
  body {
    margin: 2rem auto;
    padding: 0 20px;
  }
  
  .button-section {
    margin-top: 0;
    margin-bottom: 32px;
  }
  
  button {
    display: block;
    width: 100%;
    margin-right: 0;
    margin-bottom: 12px;
  }
  
  button:last-of-type {
    margin-bottom: 0;
  }
  
  .button-helper {
    text-align: center;
    margin-left: 0;
  }
}
</style>
<h1>ãƒ¯ã‚¤ã‚¨ãƒ ãƒ¯ãƒ¼ã‚¯ã‚¹</h1>
<small>ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã¸ã®ã”å”åŠ›ã€èª ã«ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚</small>
<!-- â˜…4-5 ç”¨ -->
<div id="highMsg" class="high hidden">
  <div class="rating-thanks">â­ é«˜è©•ä¾¡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼</div>
  ã‚‚ã—ã‚ˆã‚ã—ã‘ã‚Œã°ã€Googleã«ã‚‚åŒã˜ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æŠ•ç¨¿ã„ãŸã ã‘ã‚‹ã¨<br>
  ä»–ã®ãŠå®¢æ§˜ã®å‚è€ƒã«ãªã‚Šã€å¤§å¤‰å¬‰ã—ã„ã§ã™ã€‚
</div>
<!-- â˜…1-3 ç”¨ -->
<p id="lowMsg" class="low hidden">
  ã“ã®åº¦ã¯ã”æœŸå¾…ã«æ·»ãˆãšã€ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã§ã—ãŸã€‚<br>
  ãŠå®¢æ§˜ã«ã”æº€è¶³ã„ãŸã ã‘ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã§ããªã‹ã£ãŸã“ã¨ã€å¿ƒã‚ˆã‚ŠãŠè©«ã³ç”³ã—ä¸Šã’ã¾ã™ã€‚<br>
  ã„ãŸã ã„ãŸã”æ„è¦‹ã‚’çœŸæ‘¯ã«å—ã‘æ­¢ã‚ã€ã‚µãƒ¼ãƒ“ã‚¹ã®æ”¹å–„ã«åŠªã‚ã¦ã¾ã„ã‚Šã¾ã™ã€‚<br>
  ã‚‚ã—ã‚ˆã‚ã—ã‘ã‚Œã°ã€å…·ä½“çš„ãªæ”¹å–„ç‚¹ã‚’ <a href="mailto:admin@ymworks.com">admin@ymworks.com</a> ã¾ã§ãŠèã‹ã›ãã ã•ã„ã€‚
</p>
<p class="helper-text">
  â†‘ ã“ã®ã¾ã¾ä½¿ãˆã¾ã™ï¼ˆç·¨é›†ã‚‚å¯èƒ½ï¼‰
</p>
<textarea id="txt"></textarea>

<!-- ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼ˆé«˜è©•ä¾¡æ™‚ã®ã¿è¡¨ç¤ºï¼‰ -->
<div id="stepIndicator" class="step-indicator">
  <div class="step" id="step1">
    <span class="step-number">1</span>
    <span>å…¥åŠ›</span>
  </div>
  <div class="step-connector"></div>
  <div class="step" id="step2">
    <span class="step-number">2</span>
    <span>ã‚³ãƒ”ãƒ¼</span>
  </div>
  <div class="step-connector"></div>
  <div class="step" id="step3">
    <span class="step-number">3</span>
    <span>æŠ•ç¨¿</span>
  </div>
</div>

<div class="button-section">
  <button id="copy" class="primary">ğŸ“‹ ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ã‚³ãƒ”ãƒ¼</button>
  <button id="gbtn" class="secondary" disabled>Googleã‚¯ãƒã‚³ãƒŸã‚’æ›¸ã</button>
  <span id="copyHelper" class="copy-helper">ã‚³ãƒ”ãƒ¼ã—ãŸå†…å®¹ã‚’è²¼ã‚Šä»˜ã‘ã‚‹ã ã‘</span>
</div>

<!-- ç‰¹å…¸å‘ŠçŸ¥ï¼ˆé«˜è©•ä¾¡æ™‚ã®ã¿ï¼‰ -->
<div id="benefitNote" class="benefit-note hidden">
  ğŸ æŠ•ç¨¿ã„ãŸã ã„ãŸãŠå®¢æ§˜ã¯ã€ãœã²ã‚¹ã‚¿ãƒƒãƒ•ã«ãŠå£°ãŒã‘ãã ã•ã„
</div>
<div id="toast" class="toast"></div>
<script>
const PLACE_ID = 'ChIJi36eeSgoAWARJd6g5QUce6k';   // è‡ªç¤¾ Place ID ã«å·®ã—æ›¿ãˆ
/* -------- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾— -------- */
const qs      = new URLSearchParams(location.search);
const comment = decodeURIComponent(qs.get('comment') || '');
const rating  = Number(qs.get('rating')   || 0);   // 1ã€œ5 ã‚’æƒ³å®š
/* -------- DOM -------- */
const txt  = document.getElementById('txt');
const copy = document.getElementById('copy');
const btn  = document.getElementById('gbtn');
const hi   = document.getElementById('highMsg');
const lo   = document.getElementById('lowMsg');
const toast = document.getElementById('toast');
const copyHelper = document.getElementById('copyHelper');
const benefitNote = document.getElementById('benefitNote');
let isCopied = false;

/* -------- Toasté€šçŸ¥ -------- */
function showToast(message) {
  toast.textContent = message;
  toast.classList.add('show');
  setTimeout(() => {
    toast.classList.remove('show');
  }, 2000);
}

/* -------- åˆæœŸè¡¨ç¤º -------- */
txt.value = comment;
/* -------- ã‚³ãƒ”ãƒ¼å‡¦ç† -------- */
copy.onclick = () => {
  if (txt.value.trim()) {
    navigator.clipboard.writeText(txt.value)
      .then(() => {
        // ã‚³ãƒ”ãƒ¼å®Œäº†ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
        copy.textContent = 'âœ… ã‚³ãƒ”ãƒ¼å®Œäº†';
        copy.className = 'copied';
        isCopied = true;
        
        // Googleãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
        btn.disabled = false;
        btn.innerHTML = 'â†’ Googleã‚¯ãƒã‚³ãƒŸã‚’æ›¸ã';
        
        // é«˜è©•ä¾¡ã®å ´åˆã®ã¿ãƒ‘ãƒ«ã‚¹ã¨ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’è¡¨ç¤º
        if (rating >= 4) {
          btn.className = 'primary pulse';
          copyHelper.classList.add('show');
        } else {
          btn.className = 'primary';
        }
        
        // Toastè¡¨ç¤º
        showToast('ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
        
        // 3ç§’å¾Œã«ã‚³ãƒ”ãƒ¼æ¸ˆã¿çŠ¶æ…‹ã«
        setTimeout(() => {
          copy.innerHTML = 'âœ“ ã‚³ãƒ”ãƒ¼æ¸ˆã¿';
          copy.className = 'secondary';
          // disabledã¯å‰Šé™¤ã—ã¦ã€å†åº¦ã‚³ãƒ”ãƒ¼å¯èƒ½ã«ã™ã‚‹
        }, 3000);
      })
      .catch(() => {
        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã‚’è¿½åŠ 
        txt.select();
        try {
          document.execCommand('copy');
          copy.textContent = 'âœ… ã‚³ãƒ”ãƒ¼å®Œäº†';
          copy.className = 'copied';
          
          btn.disabled = false;
          btn.innerHTML = 'â†’ Googleã‚¯ãƒã‚³ãƒŸã‚’æ›¸ã';
          
          // é«˜è©•ä¾¡ã®å ´åˆã®ã¿ãƒ‘ãƒ«ã‚¹ã¨ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’è¡¨ç¤º
          if (rating >= 4) {
            btn.className = 'primary pulse';
            copyHelper.classList.add('show');
          } else {
            btn.className = 'primary';
          }
          
          showToast('ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
          
          setTimeout(() => {
            copy.innerHTML = 'âœ“ ã‚³ãƒ”ãƒ¼æ¸ˆã¿';
            copy.className = 'secondary';
            // disabledã¯å‰Šé™¤ã—ã¦ã€å†åº¦ã‚³ãƒ”ãƒ¼å¯èƒ½ã«ã™ã‚‹
          }, 3000);
        } catch(err) {
          showToast('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ');
        }
      });
  } else {
    showToast('ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“');
  }
};
/* -------- ãƒ•ã‚©ãƒ­ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åˆ†å² -------- */
if (rating >= 4) {
  hi.classList.remove('hidden');   // é«˜è©•ä¾¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
  benefitNote.classList.remove('hidden');  // ç‰¹å…¸è¡¨ç¤º
} else {
  lo.classList.remove('hidden');   // ä½è©•ä¾¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
}

/* -------- Googleãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ -------- */
btn.onclick = () => {
  window.open('https://search.google.com/local/writereview?placeid=' + PLACE_ID, '_blank');
};

/* -------- ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›æ™‚ã®å‡¦ç† -------- */
txt.addEventListener('input', function() {
  // ãƒ†ã‚­ã‚¹ãƒˆãŒå¤‰æ›´ã•ã‚ŒãŸã‚‰ã€ã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³ã‚’å¾©æ´»ã•ã›ã‚‹
  if (isCopied && copy.textContent === 'âœ“ ã‚³ãƒ”ãƒ¼æ¸ˆã¿') {
    copy.innerHTML = 'ğŸ“‹ ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ã‚³ãƒ”ãƒ¼';
    copy.className = 'primary';
    copy.disabled = false;
    isCopied = false;
    
    // ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’éè¡¨ç¤ºã«
    copyHelper.classList.remove('show');
  }
});
</script>
